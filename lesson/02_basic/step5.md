Start - [1](step1.md) - [2](step2.md) - [3](step3.md) - [4](step4.md) - [**5**](step5.md) - [6](step6.md) - [7](step7.md) - [8](step8.md) - [9](step9.md) - [10](step10.md) - [11](step11.md) - [12](step12.md) - End


# 変数について

課題2では以下のファイルをすべてのターゲットサーバに配布しました。

```text
ターゲットサーバに配置されるファイルです。
このサーバのホスト名は「target-server-01」です。
Ansible実行後にターゲットサーバに配置されていることを確認してください。
```

ここでは敢えてホスト名を記載していますが、2号機にも同様のファイルが配布されてしまうため、
正しく配布するためにはサーバごとにファイルの内容を書き換えなければなりません。  
このような実行対象によって処理の異なる操作を行いたい場合は「変数」を使います。

## templateモジュールについて

Ansibleには[templateモジュール](https://docs.ansible.com/ansible/2.9_ja/modules/template_module.html)というモジュールがあり、
これを使うと「配布するファイルに変数を埋め込んでおき、実行時に変数を展開した内容のファイルを配布する」という操作を行えます。  
なお、ここでは詳細を割愛しますがtemplateモジュールで配布するテンプレートファイルはJinja2というフォーマットで記載する必要があります。  
上記の内容のファイルをホスト名部分だけ変数化したテンプレートファイルは以下のようになります。

```text
ターゲットサーバに配置されるファイルです。
このサーバのホスト名は「{{ server_hostname }}」です。
Ansible実行後にターゲットサーバに配置されていることを確認してください。
```

`{{ }}`で括られた文字列が変数として認識されます。

## 変数の定義方法について

上記のテンプレートファイルではホスト名部分を `server_hostname` という名前の変数に書き換えていますが、
この時点ではどこにも`server_hostname`の値（具体的な中身）を定義していないため、どこかに値を定義する必要があります。  
Ansibleで変数定義を行える場所はいくつかありますが、一般的にはhost_varsやgroup_varsといったものがよく使われます。  
簡易的な構成でよい場合はインベントリファイルに定義する方法もあります。  
どこに変数を定義するかによって定義方法は微妙に変わってくるため、具体的な方法については実際に使っていく過程で学んでください。

---

- [前のページに戻る](step4a.md)
- [目次](README.md)
- [次のページに進む](step6.md)
